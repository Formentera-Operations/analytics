version: 2

models:
  - name: fct_facility_monthly
    description: >
      Monthly production/injection balance at the ProdView facility level.
      A facility (pvFacility) is a multi-well aggregate entity — a battery,
      tank battery, lease aggregate, or gathering group. This fact covers
      the full volume balance per facility per month: production inputs,
      gathered completion volumes, receipts in, injected volumes, consumed
      volumes, dispositions out, inventory changes, and balance status flags.

      Sourced from PVT_PVFACILITYMONTHCALC — a system-generated calc rollup
      (not raw gauge readings). This is the primary mart target for
      facility-level balance analytics per the ProdView entity model.

      **Grain:** one row per monthly calc record (one per facility per month).
      Unique on (id_rec_facility, facility_month).

      **Facility EID enrichment (Sprint 9):** `stg_prodview__facilities` is joined to
      expose `facility_eid` (pvFacility.IDPa), `facility_name`, and `facility_type_*`.
      Note: `facility_eid` is a FACILITY-LEVEL identifier — it does NOT map to
      `well_360.eid` (0 / 2,086 IDPa values match any well EID; different namespace).
      96.4% of monthly records have a `facility_eid` populated; 3.6% are unresolved.

      **Propane/butane columns** remain in m³ (no project macro available
      for propane/butane unit conversion).
    config:
      tags: ["marts", "fo", "well_360"]
    columns:
      - name: facility_monthly_sk
        description: Surrogate key. MD5(id_rec). Unique per monthly calc record.
        data_tests:
          - not_null
          - unique

      - name: id_rec
        description: ProdView monthly calc record ID (PVT_PVFACILITYMONTHCALC natural key).
        data_tests:
          - not_null

      - name: id_rec_facility
        description: >
          ProdView facility record ID (FK to pvFacility.idrec). Use as the
          grain key alongside facility_month. Join to stg_prodview__facilities
          on id_rec for facility header details.
        data_tests:
          - not_null

      - name: facility_eid
        description: >
          Facility production accounting ID (pvFacility.IDPa). This is a
          FACILITY-LEVEL identifier, NOT a well EID. It does not cross-reference
          well_360.eid (different namespace). NULL for 3.6% of monthly records
          (facilities where IDPa is not populated in ProdView).

      - name: facility_name
        description: Facility display name from ProdView pvFacility header.

      - name: facility_type_1
        description: User-defined facility type 1 from pvFacility header.

      - name: facility_type_2
        description: User-defined facility type 2 from pvFacility header.

      - name: is_facility_eid_unresolved
        description: >
          True when facility_eid is NULL — facility header has no IDPa populated.
          3.6% of monthly records as of Sprint 9.

      - name: facility_month
        description: >
          First day of the calculation month (date_trunc to month from
          period_start_date). Primary time grain key alongside id_rec_facility.
        data_tests:
          - not_null

      - name: period_start_date
        description: Start date of the calculation period from ProdView.

      - name: period_end_date
        description: End date of the calculation period from ProdView.

      - name: calculation_year
        description: Calendar year of the calculation period (integer).

      - name: calculation_month
        description: Calendar month (1-12) of the calculation period (integer).

      - name: produced_hcliq_bbl
        description: Total facility hydrocarbon liquid production in barrels for the month.

      - name: produced_gas_mcf
        description: Total facility gas production in Mcf for the month.

      - name: produced_gas_plus_gas_eq_mcf
        description: Total facility gas + gas equivalent of liquids production in Mcf.

      - name: produced_water_bbl
        description: Total facility water production in barrels for the month.

      - name: produced_gross_boe
        description: >
          Derived gross facility BOE: produced_hcliq_bbl + produced_gas_mcf / 6.
          Uses 6:1 gas-to-oil conversion. NULL inputs treated as 0.

      - name: gathered_comp_hcliq_bbl
        description: Gathered new production hydrocarbon liquid from completions in barrels.

      - name: gathered_comp_gas_mcf
        description: Gathered new production gas from completions in Mcf.

      - name: gathered_comp_water_bbl
        description: Gathered new production water from completions in barrels.

      - name: all_products_balanced
        description: True when all product streams are balanced at this facility for the month.

      - name: hcliq_balanced
        description: True when the hydrocarbon liquid stream is balanced.

      - name: gas_balanced
        description: True when the gas stream is balanced.

      - name: water_balanced
        description: True when the water stream is balanced.

      - name: volume_balance_hcliq_bbl
        description: >
          Volume balance for hydrocarbon liquid (production in minus disposition
          out minus inventory change) in barrels. Near-zero when balanced.

      - name: volume_balance_gas_mcf
        description: Volume balance for gas in Mcf. Near-zero when balanced.

      - name: proration_factor_hcliq
        description: >
          Hydrocarbon liquid proration factor (unitless ratio). Used by ProdView
          to allocate facility-level volumes back to individual completions.

      - name: proration_factor_gas
        description: Gas proration factor (unitless ratio).

      - name: opening_inventory_hcliq_bbl
        description: Opening tank inventory of hydrocarbon liquid in barrels.

      - name: closing_inventory_hcliq_bbl
        description: Closing tank inventory of hydrocarbon liquid in barrels.

      - name: change_in_inventory_hcliq_bbl
        description: Net change in hydrocarbon liquid inventory during the month.

      - name: produced_propane_m3
        description: >
          Propane production in cubic meters (m³). No project macro available for
          propane/butane conversion — remains in ProdView native unit.

      - name: produced_butane_m3
        description: Butane production in cubic meters (m³). Native ProdView unit.

      - name: _loaded_at
        description: Timestamp when this row was loaded into the data warehouse.

  - name: fct_completion_parameters_daily
    description: >
      Daily surveillance measurements per ProdView completion: pressures,
      temperatures, choke size, fluid properties, and plunger lift operations.
      Enables time-series pressure monitoring, plunger cycle tracking, and
      operational surveillance at the well level.

      No legacy equivalent — this is a new mart. Previously only consumed
      by legacy wiserock_app views.

      **Grain:** one row per parameter measurement record (id_rec from
      PVT_PVUNITCOMPPARAM). Typically one measurement per day per active
      completion during surveillance periods. measurement_date is cast from
      timestamp_ntz to date for grain clarity.

      **EID resolution:** same three-hop chain as fct_completion_downtime —
      parameter.id_rec_parent (completion ID) → completions.id_rec_parent
      (unit ID) → well_360.prodview_unit_id. ~99.9% resolved.
    config:
      tags: ["marts", "fo", "well_360"]
    columns:
      - name: completion_parameter_daily_sk
        description: Surrogate key. MD5(id_rec). Unique per parameter measurement record.
        data_tests:
          - not_null
          - unique

      - name: id_rec
        description: ProdView completion parameter record ID (PVT_PVUNITCOMPPARAM natural key).
        data_tests:
          - not_null

      - name: id_rec_comp
        description: ProdView completion record ID — the completion this measurement belongs to.
        data_tests:
          - not_null

      - name: eid
        description: >
          Well EID — canonical business key joining to well_360. ~99.9% resolved.
        data_tests:
          - not_null:
              config:
                severity: warn
          - relationships:
              arguments:
                to: ref('well_360')
                field: eid
              config:
                severity: warn

      - name: is_eid_unresolved
        description: True when EID join produced no match in well_360.
        data_tests:
          - not_null

      - name: measurement_date
        description: Date of the surveillance measurement (cast from ProdView timestamp_ntz).
        data_tests:
          - not_null

      - name: tubing_pressure_psi
        description: Tubing pressure in PSI at time of measurement.

      - name: casing_pressure_psi
        description: Casing pressure in PSI.

      - name: annulus_pressure_psi
        description: Annulus pressure in PSI.

      - name: wellhead_pressure_psi
        description: Wellhead pressure in PSI.

      - name: bottomhole_pressure_psi
        description: Bottom-hole pressure in PSI (may be measured or modeled).

      - name: shut_in_tubing_pressure_psi
        description: Shut-in tubing pressure in PSI (measured when well is shut in).

      - name: shut_in_casing_pressure_psi
        description: Shut-in casing pressure in PSI.

      - name: wellhead_temp_f
        description: Wellhead temperature in degrees Fahrenheit.

      - name: bottomhole_temp_f
        description: Bottom-hole temperature in degrees Fahrenheit.

      - name: treater_temp_f
        description: Treater vessel temperature in degrees Fahrenheit.

      - name: choke_size_64ths
        description: Choke bean size in 64ths of an inch.

      - name: h2s_daily_reading_ppm
        description: Hydrogen sulfide (H2S) daily reading in parts per million.

      - name: cycles
        description: Plunger lift cycles per day.

      - name: arrivals
        description: Plunger arrivals per day.

      - name: travel_time_min
        description: Plunger travel time in minutes.

      - name: after_flow_min
        description: After-flow time following plunger arrival in minutes.

      - name: shut_in_time_min
        description: Shut-in time per plunger cycle in minutes.

      - name: _loaded_at
        description: Timestamp when this row was loaded into the data warehouse.

  - name: fct_tank_inventory_daily
    description: >
      Daily tank inventory volumes per ProdView tank, with EID resolved from
      well_360. Provides opening/closing/change-in-inventory for oil+condensate,
      water, and sand at the tank level.

      Replaces fct_eng_tank_inventories functionally (legacy model retained
      until Sprint 7 deprecation). Key improvements over legacy:
      - Full history (legacy has a 3-year rolling window)
      - EID resolved to well_360 (legacy only carries unit_id)
      - No facility_id IS NOT NULL filter — retains all tanks
      - Tank attributes denormalized in (tank_name, product, capacity)

      **Grain:** one row per daily tank volume record (id_rec from
      PVT_PVUNITTANKMONTHDAYCALC).

      **EID resolution:** tanks.id_rec_parent (unit_id) → well_360.prodview_unit_id
      (primary) + units.api_10 fallback. ~70.4% resolved — the 29.6% unresolved
      rows represent facility/battery-level tanks associated with pvfac units
      that don't map to individual well EIDs. These will be covered by
      fct_facility_monthly in Sprint 7. Filter WHERE eid IS NOT NULL for
      well-level analysis.
    config:
      tags: ["marts", "fo", "well_360"]
    columns:
      - name: tank_inventory_daily_sk
        description: Surrogate key. MD5(id_rec). Unique per daily tank volume record.
        data_tests:
          - not_null
          - unique

      - name: id_rec
        description: ProdView daily tank volume record ID (PVT_PVUNITTANKMONTHDAYCALC natural key).
        data_tests:
          - not_null

      - name: tank_id
        description: FK to stg_prodview__tanks.id_rec — the tank that was measured.
        data_tests:
          - not_null

      - name: id_rec_unit
        description: >
          ProdView unit ID that owns this tank (from stg_prodview__tanks.id_rec_parent).
          May be a pvunitcomp (well completion), pvunit (battery), or pvfac (facility).

      - name: eid
        description: >
          Well EID — canonical business key joining to well_360. ~70.4% resolved.
          The 29.6% unresolved represents facility/battery-level tanks (pvfac units)
          that don't correspond to individual well EIDs.
          Filter WHERE eid IS NOT NULL for well-level-only analysis.
        data_tests:
          - not_null:
              config:
                severity: warn
          - relationships:
              arguments:
                to: ref('well_360')
                field: eid
              config:
                severity: warn

      - name: is_eid_unresolved
        description: True when unit → well_360 join produced no EID match.
        data_tests:
          - not_null

      - name: tank_date
        description: Date of the daily tank inventory reading.
        data_tests:
          - not_null

      - name: tank_name
        description: Descriptive name of the tank from stg_prodview__tanks.

      - name: tank_product
        description: Product stored in this tank (Oil, Water, Sand, etc.).

      - name: tank_capacity_bbl
        description: Total tank capacity in barrels.

      - name: exclude_from_production
        description: True when tank is flagged to exclude from production accounting.

      - name: is_tank_active
        description: True when stop_using_tank is NULL (tank still in use).

      - name: opening_total_volume_bbl
        description: Total tank volume at start of day in barrels.

      - name: opening_oil_condensate_volume_bbl
        description: Oil + condensate volume at start of day in barrels.

      - name: opening_gas_equivalent_oil_cond_volume_mcf
        description: Gas equivalent of oil + condensate opening volume in Mcf.

      - name: opening_water_volume_bbl
        description: Water volume at start of day in barrels.

      - name: opening_bsw_total_pct
        description: Basic sediment and water percentage at start of day (0-100 scale).

      - name: closing_total_volume_bbl
        description: Total tank volume at end of day in barrels.

      - name: closing_oil_condensate_volume_bbl
        description: Oil + condensate volume at end of day in barrels.

      - name: closing_gas_equivalent_oil_cond_volume_mcf
        description: Gas equivalent of oil + condensate closing volume in Mcf.

      - name: closing_water_volume_bbl
        description: Water volume at end of day in barrels.

      - name: closing_bsw_total_pct
        description: Basic sediment and water percentage at end of day (0-100 scale).

      - name: change_total_volume_bbl
        description: Net change in total tank volume during the day in barrels.

      - name: change_oil_condensate_volume_bbl
        description: Net change in oil + condensate volume during the day in barrels.

      - name: change_gas_equivalent_oil_cond_volume_mcf
        description: Net change in gas equivalent of oil + condensate during the day in Mcf.

      - name: change_water_volume_bbl
        description: Net change in water volume during the day in barrels.

      - name: current_facility_id
        description: FK to the facility this tank is currently associated with.

      - name: _loaded_at
        description: Timestamp when this row was loaded into the data warehouse.

  - name: fct_well_test
    description: >
      Per-event production test fact for ProdView completions. Each row is one
      production test (PI test, injection ratio, flowback test, etc.) with
      measured volumes, calculated rates, quality ratios, pressure/temperature
      conditions, and ProdView-computed change-from-prior metrics.

      Enables PI trending, GOR/WOR monitoring, and test-over-test decline
      analysis by joining on (eid ORDER BY effective_date).

      **Grain:** one row per production test record (id_rec from PVT_PVUNITCOMPTEST).
      Tests are infrequent (typically monthly or quarterly per completion).

      **EID resolution:** same three-hop chain as fct_completion_downtime —
      test.id_rec_parent (completion ID) → completions.id_rec_parent (unit ID)
      → well_360.prodview_unit_id. api_10 fallback via completions. ~99.5% resolved.

      **Invalid tests:** rows with invalid_test = 'Y' are retained.
      Filter `WHERE coalesce(invalid_test, 'N') != 'Y'` for valid-only analyses.
    config:
      tags: ["marts", "fo", "well_360"]
    columns:
      - name: well_test_sk
        description: Surrogate key. MD5(id_rec). Unique per production test record.
        data_tests:
          - not_null
          - unique

      - name: id_rec
        description: ProdView production test record ID (natural key from PVT_PVUNITCOMPTEST).
        data_tests:
          - not_null

      - name: id_rec_comp
        description: ProdView completion record ID — the completion that was tested.
        data_tests:
          - not_null

      - name: eid
        description: >
          Well EID — canonical business key joining to well_360. NULL for completions
          without a well_360 match. ~99.5% resolved in dev build.
        data_tests:
          - not_null:
              config:
                severity: warn
          - relationships:
              arguments:
                to: ref('well_360')
                field: eid
              config:
                severity: warn

      - name: is_eid_unresolved
        description: True when EID join produced no match in well_360.
        data_tests:
          - not_null

      - name: effective_date
        description: Date the production test was performed.
        data_tests:
          - not_null

      - name: test_type
        description: >
          ProdView test type classification (e.g., Production, Injection, Flowback).

      - name: test_hours
        description: Duration of the test in hours.

      - name: invalid_test
        description: >
          'Y' if the test was flagged as invalid in ProdView (do not use flag).
          NULL or 'N' for valid tests. Do NOT filter this in the mart — retain all rows.

      - name: tested_by
        description: Name or ID of the person who conducted the test.

      - name: choke_size_64ths
        description: Choke size at time of test in 64ths of an inch.

      - name: oil_cond_rate_bbl_per_day
        description: Calculated oil + condensate rate in bbl/day from the test.

      - name: produced_gas_rate_mcf_per_day
        description: Calculated produced gas rate in Mcf/day from the test.

      - name: water_rate_bbl_per_day
        description: Calculated water rate in bbl/day from the test.

      - name: total_fluid_rate_bbl_per_day
        description: Total liquid (oil + water) rate in bbl/day from the test.

      - name: gross_boe_rate_bbl_per_day
        description: >
          Derived gross BOE rate: oil_cond_rate_bbl_per_day + produced_gas_rate_mcf_per_day / 6.
          Uses 6:1 gas-to-oil conversion. NULL inputs treated as 0.
        data_tests:
          - not_null

      - name: gas_oil_ratio_mcf_per_bbl
        description: Gas-oil ratio in Mcf/bbl calculated by ProdView.

      - name: condensate_gas_ratio_bbl_per_mcf
        description: Condensate-gas ratio in bbl/Mcf.

      - name: water_gas_ratio_bbl_per_mcf
        description: Water-gas ratio in bbl/Mcf.

      - name: total_bsw_pct
        description: Total basic sediment and water percentage (0-100 scale).

      - name: pressure_wellhead_psi
        description: Wellhead pressure in PSI at time of test.

      - name: pressure_bh_psi
        description: Bottom-hole pressure in PSI at time of test.

      - name: temperature_well_head_f
        description: Wellhead temperature in degrees Fahrenheit.

      - name: temperature_bottom_hole_f
        description: Bottom-hole temperature in degrees Fahrenheit.

      - name: allocation_flag
        description: Whether this test is used for allocation purposes.

      - name: deliverability_flag
        description: Whether this test is used for deliverability calculations.

      - name: regulatory_flag
        description: Whether this test is submitted for regulatory reporting.

      - name: _loaded_at
        description: Timestamp when this row was loaded into the data warehouse.

  - name: fct_production_target_daily
    description: >
      Daily production target rates per ProdView completion, with EID resolved
      from well_360. Enables target vs actual variance analysis when joined with
      fct_well_production_daily on (eid, allocation_date = target_daily_date).

      The parent target record (PVT_PVUNITCOMPTARGET) defines a target period
      with a type (Budget, Forecast) and optional ComboCurve forecast name.
      Child records (PVT_PVUNITCOMPTARGETDAY) provide per-day rates within
      that period. This fact denormalizes both levels into a single daily row.

      **Grain:** one row per daily target record (id_rec from PVT_PVUNITCOMPTARGETDAY).
      A completion may have multiple rows per date when target types overlap
      (e.g., Budget and Actuals for the same day).

      **EID resolution:** four-hop chain — target_daily.id_rec_parent → target.id_rec
      → target.id_rec_parent (completion ID) → completion.id_rec_parent (unit ID)
      → well_360.prodview_unit_id. 100% resolved in dev build.
    config:
      tags: ["marts", "fo", "well_360"]
    columns:
      - name: production_target_daily_sk
        description: Surrogate key. MD5(id_rec). Unique per daily target record.
        data_tests:
          - not_null
          - unique

      - name: id_rec
        description: ProdView daily target record ID (PVT_PVUNITCOMPTARGETDAY natural key).
        data_tests:
          - not_null

      - name: id_rec_target
        description: FK to the parent target period record (PVT_PVUNITCOMPTARGET.idrec).

      - name: id_rec_comp
        description: ProdView completion record ID this target belongs to.

      - name: eid
        description: >
          Well EID — canonical business key joining to well_360.
          100% resolved in dev build (all target records trace to a completion
          with a well_360 match).
        data_tests:
          - not_null:
              config:
                severity: warn
          - relationships:
              arguments:
                to: ref('well_360')
                field: eid
              config:
                severity: warn

      - name: is_eid_unresolved
        description: True when EID join produced no match in well_360.
        data_tests:
          - not_null

      - name: target_daily_date
        description: The specific date this target rate applies to. Join key with fct_well_production_daily.allocation_date.
        data_tests:
          - not_null

      - name: target_start_date
        description: Start date of the parent target period.

      - name: target_type
        description: Classification of the target period (Budget, Forecast, Actual, etc.).

      - name: cc_forecast_name
        description: ComboCurve forecast name driving this target period (from usertxt1 on parent record).

      - name: is_use_in_diff_from_target_calculations
        description: >
          True when this target period is flagged for use in difference-from-target
          calculations (ProdView's built-in variance engine).

      - name: target_daily_rate_oil_bbl_per_day
        description: Target daily oil rate in bbl/day.

      - name: target_daily_rate_gas_mcf_per_day
        description: Target daily gas rate in Mcf/day.

      - name: target_daily_rate_hcliq_bbl_per_day
        description: Target daily hydrocarbon liquid rate in bbl/day.

      - name: target_daily_rate_condensate_bbl_per_day
        description: Target daily condensate rate in bbl/day.

      - name: target_daily_rate_ngl_bbl_per_day
        description: Target daily NGL rate in bbl/day.

      - name: target_daily_rate_water_bbl_per_day
        description: Target daily water rate in bbl/day.

      - name: target_daily_rate_sand_bbl_per_day
        description: Target daily sand rate in bbl/day.

      - name: target_daily_rate_gross_boe_per_day
        description: >
          Derived gross BOE target rate: target_daily_rate_oil_bbl_per_day +
          target_daily_rate_gas_mcf_per_day / 6. Null inputs treated as 0.

      - name: _loaded_at
        description: Timestamp when this row was loaded into the data warehouse.

  - name: fct_completion_downtime
    description: >
      Event-level downtime fact for ProdView completions. Each row represents
      one contiguous downtime event (island of consecutive single-day records
      sharing the same downtime codes), retaining full production history.

      Replaces fct_eng_completion_downtimes functionally (legacy model retained
      until Sprint 7 deprecation). Both coexist as independent facts.

      **Grain:** one row per contiguous downtime event per completion. Multiple
      consecutive single-day downtime records with the same (id_rec_comp,
      downtime_code_1/2/3) are merged into a single event via the
      islands+gaps algorithm.

      **EID resolution:** three-hop chain — downtime.id_rec_parent (completion
      ID) → stg_prodview__completions.id_rec_parent (unit ID) →
      well_360.prodview_unit_id (primary). api_10 fallback via
      stg_prodview__completions.api_10. ~99.4% resolution in dev build.

      **Legacy cutoff removed:** the existing int_prodview__completion_downtimes
      filters to first_day > 2021-12-31. This fact carries full history.
    config:
      tags: ["marts", "fo", "well_360"]
    columns:
      - name: downtime_event_sk
        description: >
          Surrogate key. MD5(downtime_event_id). Unique per contiguous
          downtime event. Guaranteed unique across all rows.
        data_tests:
          - not_null
          - unique

      - name: downtime_event_id
        description: >
          Natural grain key. The minimum id_rec within the island of consecutive
          source records that form this contiguous event. Stable across runs.
        data_tests:
          - not_null

      - name: id_rec_comp
        description: >
          ProdView completion record ID (FK to stg_prodview__completions.id_rec).
          The completion that experienced this downtime event.
        data_tests:
          - not_null

      - name: eid
        description: >
          Well EID — canonical business key joining to well_360. NULL for
          completions without a well_360 match (non-operated, SWD, FP Griffin
          without EID backfill). ~99.4% resolved in dev build.
        data_tests:
          - not_null:
              config:
                severity: warn
          - relationships:
              arguments:
                to: ref('well_360')
                field: eid
              config:
                severity: warn

      - name: is_eid_unresolved
        description: >
          True when neither prodview_unit_id nor api_10 join produced an EID
          match in well_360. Resolves automatically as EIDs are backfilled.
        data_tests:
          - not_null

      - name: event_start_date
        description: >
          First day of the contiguous downtime event (min first_day across
          merged source records in this island).
        data_tests:
          - not_null

      - name: event_end_date
        description: >
          Last day of the contiguous downtime event (max last_day across
          merged source records in this island). NULL for open-ended events.

      - name: total_downtime_hours
        description: >
          Total hours of downtime across all source records in this island.
          For non-single-day events (Range, Calculated), this is the calculated
          total from the source record.
        data_tests:
          - not_null

      - name: days_down
        description: >
          Calendar days from event_start_date to event_end_date (inclusive).
          For open-ended events, measured to yesterday (current_date - 1).

      - name: downtime_code_1
        description: Primary downtime classification code (e.g., well type, equipment category).

      - name: downtime_code_2
        description: Secondary downtime classification code (reason category).

      - name: downtime_code_3
        description: Tertiary downtime classification code (sub-reason).

      - name: downtime_type
        description: >
          ProdView downtime entry type. "Single Day" events on consecutive dates
          with the same codes are merged into one event by the islands algorithm.
          Other types (Range, Calculated) form their own single-record events.

      - name: product
        description: Product stream affected by this downtime (Oil, Gas, Water, All, etc.).

      - name: location
        description: >
          Physical location of the downtime cause (Wellbore, Surface, Pipeline, etc.).

      - name: is_failure
        description: True when ProdView flagged this downtime as an equipment or system failure.

      - name: comments
        description: Free-text comments from the operator for this downtime event.

      - name: _loaded_at
        description: Timestamp when this row was loaded into the data warehouse.

  - name: fct_well_production_daily
    description: >
      Daily production volumes per ProdView unit, with EID resolved from well_360.
      Wide-column fact carrying all mart-relevant staging columns at the source
      grain (one row per id_rec_unit × allocation_date). No volume aggregation —
      analysts GROUP BY eid when they need well-level daily summaries.

      This is the EID-resolved replacement for fct_eng_volumes (legacy model
      retained until Sprint 7 deprecation). Both coexist as independent facts.

      **Grain:** one row per (id_rec_unit, allocation_date). For resolved wells,
      eid is populated. For unresolved wells, eid is NULL and id_rec_unit is the
      only grain discriminator.

      **EID resolution:** two-step COALESCE — prodview_unit_id primary,
      api_10 fallback. ~81.5% match rate on pvunitcomp units.
      Unresolved rows (non-operated, FP Griffin without EIDs, SWD wells) are
      retained with NULL eid and `is_eid_unresolved = true`.

      **Incremental watermark:** _fivetran_synced (stable Fivetran ingestion
      timestamp). The staging VIEW's _loaded_at always returns current_timestamp()
      and is not usable as a watermark. Initial build requires --full-refresh.

      **Upstream filter:** stg_prodview__units restricted to
      `unit_type = 'pvunitcomp'` — excludes facilities, external ins/outs,
      and meters (~3K units).
    config:
      tags: ["marts", "fo", "well_360"]
    columns:
      - name: well_production_daily_sk
        description: >
          Surrogate key. MD5(id_rec_unit, allocation_date). Unique at the
          source grain (one allocation record per ProdView unit per day, after
          Fivetran re-ingestion deduplication in the fact CTE). Using id_rec_unit
          directly avoids the EID-coalesce collision where multiple units sharing
          the same EID would produce identical surrogate keys on the same date.
        data_tests:
          - not_null
          - unique

      - name: eid
        description: >
          Well EID (Entity Identifier) — canonical business key joining to well_360.
          NULL for unresolved wells (FP Griffin wells without property_eid in
          ProdView, non-operated wells, SWD/injection wells). Resolves
          automatically as EIDs are backfilled in ProdView.
        data_tests:
          - not_null:
              config:
                severity: warn
          - relationships:
              arguments:
                to: ref('well_360')
                field: eid
              config:
                severity: warn
                # ~18.5% unresolved historically; improves as EIDs are backfilled

      - name: id_rec_unit
        description: >
          ProdView unit ID (FK to stg_prodview__units.id_rec). Carried for ALL
          rows — both resolved and unresolved — to support FK bridge context,
          ProdView-side debugging, and multi-unit EID disambiguation.
        data_tests:
          - not_null

      - name: allocation_date
        description: >
          Date of the daily allocation record. Grain key alongside id_rec_unit.
        data_tests:
          - not_null

      - name: is_eid_unresolved
        description: >
          True when neither the prodview_unit_id nor api_10 join produced an EID
          match in well_360. Resolves automatically as EIDs are added to ProdView.
        data_tests:
          - not_null

      - name: id_rec
        description: >
          ProdView daily allocation record ID (source natural key from
          PVT_PVUNITALLOCMONTHDAY). Useful for tracing back to the exact
          source record when debugging volume discrepancies.

      - name: id_rec_comp
        description: ProdView completion ID this allocation belongs to.

      - name: id_rec_comp_zone
        description: ProdView completion zone ID.

      - name: id_flownet
        description: ProdView flow network ID governing allocation hierarchy.

      - name: allocation_year
        description: Calendar year of the allocation date (convenience column).

      - name: allocation_month
        description: Calendar month (1-12) of the allocation date (convenience column).

      - name: allocation_day_of_month
        description: Day of month (1-31) of the allocation date (convenience column).

      - name: downtime_hours
        description: Hours the well was down (non-producing) on this allocation date.

      - name: operating_time_hours
        description: Hours the well was actively producing on this allocation date.

      - name: gathered_hcliq_bbl
        description: Gathered hydrocarbon liquid volumes in barrels (pre-allocation).

      - name: gathered_gas_mcf
        description: Gathered gas volumes in Mcf (pre-allocation).

      - name: gathered_water_bbl
        description: Gathered produced water volumes in barrels (pre-allocation).

      - name: gathered_sand_bbl
        description: Gathered sand volumes in barrels (pre-allocation).

      - name: allocated_hcliq_bbl
        description: Allocated hydrocarbon liquid (oil + condensate + NGL) in barrels.

      - name: allocated_oil_bbl
        description: Allocated oil production in barrels.

      - name: allocated_condensate_bbl
        description: Allocated condensate production in barrels.

      - name: allocated_ngl_bbl
        description: Allocated NGL production in barrels.

      - name: allocated_gas_eq_hcliq_mcf
        description: Gas equivalent of allocated hydrocarbon liquid in Mcf.

      - name: allocated_gas_mcf
        description: Allocated gas production in Mcf.

      - name: allocated_water_bbl
        description: Allocated produced water in barrels.

      - name: allocated_sand_bbl
        description: Allocated sand in barrels.

      - name: gross_boe
        description: >
          Daily gross barrel of oil equivalent. Formula: allocated_oil_bbl +
          (allocated_gas_mcf / 6). Uses 6:1 gas-to-oil conversion ratio
          (industry standard for US operations).
        data_tests:
          - not_null

      - name: alloc_factor_hcliq
        description: Hydrocarbon liquid allocation factor (unitless ratio).

      - name: alloc_factor_gas
        description: Gas allocation factor (unitless ratio).

      - name: alloc_factor_water
        description: Water allocation factor (unitless ratio).

      - name: alloc_factor_sand
        description: Sand allocation factor (unitless ratio).

      - name: new_prod_hcliq_bbl
        description: New production hydrocarbon liquid in barrels (excludes recovered load).

      - name: new_prod_oil_bbl
        description: New production oil in barrels.

      - name: new_prod_condensate_bbl
        description: New production condensate in barrels.

      - name: new_prod_ngl_bbl
        description: New production NGL in barrels.

      - name: new_prod_hcliq_gas_eq_mcf
        description: New production hydrocarbon liquid gas equivalent in Mcf.

      - name: new_prod_gas_mcf
        description: New production gas in Mcf.

      - name: new_prod_water_bbl
        description: New production water in barrels.

      - name: new_prod_sand_bbl
        description: New production sand in barrels.

      - name: wi_hcliq_pct
        description: Working interest percentage for hydrocarbon liquid (0-100 scale).

      - name: wi_gas_pct
        description: Working interest percentage for gas (0-100 scale).

      - name: wi_water_pct
        description: Working interest percentage for water (0-100 scale).

      - name: wi_sand_pct
        description: Working interest percentage for sand (0-100 scale).

      - name: nri_hcliq_pct
        description: Net revenue interest percentage for hydrocarbon liquid (0-100 scale).

      - name: nri_gas_pct
        description: Net revenue interest percentage for gas (0-100 scale).

      - name: nri_water_pct
        description: Net revenue interest percentage for water (0-100 scale).

      - name: nri_sand_pct
        description: Net revenue interest percentage for sand (0-100 scale).

      - name: deferred_hcliq_bbl
        description: Deferred (lost) hydrocarbon liquid production in barrels.

      - name: deferred_gas_mcf
        description: Deferred (lost) gas production in Mcf.

      - name: deferred_water_bbl
        description: Deferred (lost) water production in barrels.

      - name: deferred_sand_bbl
        description: Deferred (lost) sand production in barrels.

      - name: diff_target_hcliq_bbl
        description: Variance from target — hydrocarbon liquid in barrels (negative = below target).

      - name: diff_target_oil_bbl
        description: Variance from target — oil in barrels.

      - name: diff_target_condensate_bbl
        description: Variance from target — condensate in barrels.

      - name: diff_target_ngl_bbl
        description: Variance from target — NGL in barrels.

      - name: diff_target_gas_mcf
        description: Variance from target — gas in Mcf.

      - name: diff_target_water_bbl
        description: Variance from target — water in barrels.

      - name: diff_target_sand_bbl
        description: Variance from target — sand in barrels.

      - name: disp_sales_hcliq_bbl
        description: Disposition — hydrocarbon liquid sold in barrels.

      - name: disp_sales_oil_bbl
        description: Disposition — oil sold in barrels.

      - name: disp_sales_condensate_bbl
        description: Disposition — condensate sold in barrels.

      - name: disp_sales_ngl_bbl
        description: Disposition — NGL sold in barrels.

      - name: disp_sales_gas_mcf
        description: Disposition — gas sold in Mcf.

      - name: disp_fuel_gas_mcf
        description: Disposition — gas used as fuel in Mcf.

      - name: disp_flare_gas_mcf
        description: Disposition — gas flared in Mcf.

      - name: disp_incineration_gas_mcf
        description: Disposition — gas incinerated in Mcf.

      - name: disp_vent_gas_mcf
        description: Disposition — gas vented in Mcf.

      - name: disp_injected_gas_mcf
        description: Disposition — gas injected in Mcf.

      - name: disp_injected_water_bbl
        description: Disposition — water injected in barrels.

      - name: injection_well_hcliq_bbl
        description: Injection well hydrocarbon liquid volumes in barrels.

      - name: injection_well_gas_mcf
        description: Injection well gas volumes in Mcf.

      - name: injection_well_water_bbl
        description: Injection well water volumes in barrels.

      - name: injection_well_sand_bbl
        description: Injection well sand volumes in barrels.

      - name: cum_hcliq_bbl
        description: >
          ProdView cumulative hydrocarbon liquid production in barrels as of this
          date (running total maintained by ProdView at unit level).

      - name: cum_oil_bbl
        description: ProdView cumulative oil production in barrels as of this date.

      - name: cum_condensate_bbl
        description: ProdView cumulative condensate production in barrels as of this date.

      - name: cum_ngl_bbl
        description: ProdView cumulative NGL production in barrels as of this date.

      - name: cum_gas_mcf
        description: ProdView cumulative gas production in Mcf as of this date.

      - name: cum_water_bbl
        description: ProdView cumulative water production in barrels as of this date.

      - name: cum_sand_bbl
        description: ProdView cumulative sand production in barrels as of this date.

      - name: gathered_heat_mmbtu
        description: Gathered gas heat content in MMBtu.

      - name: gathered_heat_factor_btu_per_ft3
        description: Gathered gas heat factor in BTU/ft³.

      - name: allocated_heat_mmbtu
        description: Allocated gas heat content in MMBtu.

      - name: allocated_heat_factor_btu_per_ft3
        description: Allocated gas heat factor in BTU/ft³.

      - name: new_prod_heat_mmbtu
        description: New production heat content in MMBtu.

      - name: disp_sales_heat_mmbtu
        description: Sales gas heat content in MMBtu.

      - name: disp_fuel_heat_mmbtu
        description: Fuel gas heat content in MMBtu.

      - name: disp_flare_heat_mmbtu
        description: Flared gas heat content in MMBtu.

      - name: disp_vent_heat_mmbtu
        description: Vented gas heat content in MMBtu.

      - name: disp_incinerate_heat_mmbtu
        description: Incinerated gas heat content in MMBtu.

      - name: allocated_density_api
        description: Allocated liquid density in API gravity degrees.

      - name: sales_density_api
        description: Sales liquid density in API gravity degrees.

      - name: id_rec_meas_method
        description: FK to measurement method record (ProdView).

      - name: id_rec_test
        description: >
          FK to the well test record associated with this allocation day.
          Populated when a production test was run on this date. Used for
          joining to fct_well_test in Sprint 5.

      - name: id_rec_param
        description: >
          FK to the completion parameters record for this allocation day.
          Populated when pressure/temperature/choke data was recorded.

      - name: id_rec_downtime
        description: >
          FK to the downtime event record associated with this allocation day.
          Populated when downtime was recorded. Used for joining to
          fct_completion_downtime in Sprint 4.

      - name: id_rec_deferment
        description: FK to the deferment record explaining deferred volumes.

      - name: id_rec_status
        description: FK to the well status record for this allocation date.

      - name: id_rec_facility
        description: FK to the facility record this unit belongs to.

      - name: pump_efficiency_pct
        description: Pump efficiency percentage (0-100 scale).

      - name: created_at_utc
        description: Timestamp when the source ProdView record was created (UTC).

      - name: modified_at_utc
        description: Timestamp when the source ProdView record was last modified (UTC).

      - name: _fivetran_synced
        description: >
          Fivetran ingestion timestamp. Used as the incremental watermark —
          rows with _fivetran_synced newer than the fact table's max are
          included in each incremental run.

      - name: _loaded_at
        description: Timestamp when this row was loaded into the data warehouse.

  - name: fct_well_production_monthly
    description: >
      Monthly production volumes per well, joined with LOS financial context.
      Gold-layer fact — source-agnostic (ProdView today; additional sources
      can be unioned at the staging/intermediate layer without changing this
      model's column contract).

      **Grain:** one row per (eid, production_month) for resolved wells;
      one row per (id_rec_unit, production_month) for unresolved wells
      (eid IS NULL). Multiple ProdView units mapping to the same EID are
      collapsed into a single row.

      **EID resolution:** two-step COALESCE — prodview_unit_id primary,
      api_10 fallback. ~0.7% of unit-months are unresolved in production
      (historically ~18.5% before FP Griffin EID backfill was completed).
      Unresolved rows are retained with NULL eid and `is_eid_unresolved = true`.

      **LOS coverage:** ~24% in dev build (incremental fct_los has partial
      history). Full production build expected to exceed 50% LOS coverage.

      **Upstream filter:** stg_prodview__units restricted to
      `unit_type = 'pvunitcomp'` — excludes facilities, external ins/outs,
      and meters (~3K units).
    config:
      tags: ["marts", "fo", "well_360"]
    columns:
      - name: well_performance_monthly_sk
        description: >
          Surrogate key. For resolved wells: MD5(eid, production_month).
          For unresolved wells: MD5(id_rec_unit, production_month).
          Guaranteed unique across all rows.
        data_tests:
          - not_null
          - unique

      - name: eid
        description: >
          Well EID (Entity Identifier) — the canonical business key joining
          to well_360. NULL for unresolved wells (FP Griffin wells without
          property_eid backfilled in ProdView, non-operated wells, SWD wells).
        data_tests:
          - not_null:
              config:
                severity: warn
          - relationships:
              arguments:
                to: ref('well_360')
                field: eid
              config:
                severity: warn
                # ~0.7% unresolved as of 2026-02-19; historically ~18.5% before
                # FP Griffin EID backfill. Rows retained for volume completeness.

      - name: id_rec_unit
        description: >
          ProdView unit ID (FK to stg_prodview__units.id_rec). Populated for
          unresolved wells only; NULL for resolved wells where multiple units
          may map to one EID. Use for ProdView-side debugging of unresolved rows.

      - name: production_month
        description: >
          First day of the production month (date_trunc to month). Grain key
          alongside eid.
        data_tests:
          - not_null

      - name: is_eid_unresolved
        description: >
          True when neither the prodview_unit_id nor api_10 join produced an
          EID match in well_360. These rows represent FP Griffin wells awaiting
          EID backfill, non-operated wells, or SWD/injection wells. Resolves
          automatically as EIDs are added to ProdView.
        data_tests:
          - not_null

      - name: oil_bbls
        description: Monthly allocated oil production in barrels (bbls). 0 when null in source.

      - name: gas_mcf
        description: Monthly allocated gas production in thousand cubic feet (Mcf). 0 when null in source.

      - name: water_bbls
        description: Monthly allocated water production in barrels (bbls). 0 when null in source.

      - name: ngl_bbls
        description: Monthly allocated NGL production in barrels (bbls). 0 when null in source.

      - name: gross_boe
        description: >
          Monthly gross barrel of oil equivalent. Formula: oil_bbls + (gas_mcf / 6).
          Uses 6:1 gas-to-oil conversion ratio (industry standard for US operations).
        data_tests:
          - not_null

      - name: has_los_entry
        description: >
          True when int_los__well_monthly has a financial record for this
          (eid, production_month). False for months with no GL activity,
          pre-LOS-system history, or unresolved EIDs.
        data_tests:
          - not_null

      - name: los_revenue
        description: >
          Monthly LOS revenue for this well (GL category = 'Revenue').
          Pre-signed: positive. NULL when has_los_entry is false.

      - name: los_loe
        description: >
          Monthly lease operating expense (GL category = 'Lease Operating Expenses').
          Pre-signed: negative (costs are sign-flipped in fct_los). NULL when
          has_los_entry is false.

      - name: los_severance_tax
        description: >
          Monthly production and ad valorem taxes
          (GL category = 'Production & Ad Valorem Taxes'). Pre-signed: negative.
          NULL when has_los_entry is false.

      - name: los_net_income
        description: >
          Monthly net income — sum of all LOS categories for this well-month
          (Revenue + LOE + Severance Tax + all other signed categories).
          Because fct_los pre-signs all costs as negative, SUM gives net income
          directly. NULL when has_los_entry is false.

      - name: _loaded_at
        description: Timestamp when this row was loaded into the data warehouse.

  - name: fct_completion_status_history
    description: >
      Effective-dated status change events per ProdView completion. Each row
      represents one pvUnitCompStatus record — a point-in-time snapshot of a
      completion's operating status (producing, shut-in, injecting, etc.).
      Retains full history with no date cutoff. Source: PVT_PVUNITCOMPSTATUS.

      Complements fct_completion_downtime for root cause analysis and well
      lifecycle surveillance workflows. Status records describe WHAT a completion
      is doing at a point in time; downtime records describe WHEN it stopped.

      **Grain:** one row per status record (PVT_PVUNITCOMPSTATUS.IDREC).

      **EID resolution:** 3-hop identical to fct_completion_downtime.
      status.id_rec_parent → completions.id_rec → completions.id_rec_parent (unit_id)
      → well_360.prodview_unit_id (primary) OR completions.api_10 → well_360.api_10 (fallback).

      **EID resolution rate:** 72.9% (9,148 / 12,541 rows resolved as of Sprint 8).
      3,393 unresolved rows represent historical wells and non-operated completions
      not yet registered in the well_360 spine. Documented with severity: warn on
      the not_null and relationships tests for eid.
    config:
      tags: ["marts", "fo", "well_360"]
    columns:
      - name: completion_status_sk
        description: >
          Surrogate key. MD5(id_rec). Unique per status record.
        data_tests:
          - not_null
          - unique

      - name: id_rec
        description: ProdView status record ID (PVT_PVUNITCOMPSTATUS natural key).
        data_tests:
          - not_null
          - unique

      - name: id_rec_comp
        description: >
          FK to pvUnitComp (completion record ID). Equivalent to status.id_rec_parent.
          Use to join to stg_prodview__completions or stg_prodview__status.
        data_tests:
          - not_null

      - name: id_flownet
        description: Flow network identifier. ProdView IDFLOWNET.

      - name: eid
        description: >
          Well EID (Enterprise Identifier). Resolved from prodview_unit_id
          (primary) or api_10 (fallback) via well_360. NULL for ~27% of rows —
          historical completions and non-operated wells not yet in the well_360 spine.
          See model-level description for full rate breakdown.
        data_tests:
          - not_null:
              config:
                severity: warn
          - relationships:
              arguments:
                to: ref('well_360')
                field: eid
              config:
                severity: warn

      - name: is_eid_unresolved
        description: >
          True when the EID could not be resolved through either the prodview_unit_id
          or api_10 join paths. Indicates non-operated, SWD, or wells not yet in well_360.
        data_tests:
          - not_null

      - name: status_date
        description: Effective date of this status record. ProdView DTTM.
        data_tests:
          - not_null:
              config:
                severity: warn

      - name: status
        description: >
          Completion operating status at this point in time. Common values:
          'Producing', 'Shut In', 'Injecting', 'Abandoned'. ProdView STATUS.

      - name: primary_fluid_type
        description: Primary fluid type at this status snapshot. ProdView PRIMARYFLUIDTYP.

      - name: flow_direction
        description: Flow direction (producer/injector). ProdView FLOWDIRECTION.

      - name: commingled
        description: Whether the completion is commingled with others. ProdView COMMINGLED.

      - name: oil_or_condensate
        description: Whether the primary hydrocarbon is oil or condensate. ProdView TYPFLUIDPROD.

      - name: completion_type
        description: Completion type (e.g., vertical, horizontal, frac). ProdView TYPCOMPLETION.

      - name: production_method
        description: Production method (e.g., flowing, pumping, gas lift). ProdView METHODPROD.

      - name: calc_lost_production
        description: Whether to calculate lost production for this status. ProdView CALCLOSTPROD.

      - name: include_in_well_count
        description: Whether to include in well count reporting. ProdView WELLCOUNTINCL.

      - name: comments
        description: Status comments. ProdView COM.

      - name: user_txt1
        description: User-defined text field 1. ProdView USERTXT1.
      - name: user_txt2
        description: User-defined text field 2. ProdView USERTXT2.
      - name: user_txt3
        description: User-defined text field 3. ProdView USERTXT3.
      - name: user_num1
        description: User-defined numeric field 1. ProdView USERNUM1.
      - name: user_num2
        description: User-defined numeric field 2. ProdView USERNUM2.
      - name: user_num3
        description: User-defined numeric field 3. ProdView USERNUM3.

      - name: created_by
        description: User who created the status record. ProdView SYSCREATEUSER.
      - name: created_at_utc
        description: Record creation timestamp (UTC). ProdView SYSCREATEDATE.
      - name: modified_by
        description: User who last modified the record. ProdView SYSMODUSER.
      - name: modified_at_utc
        description: Last modification timestamp (UTC). ProdView SYSMODDATE.

      - name: _loaded_at
        description: Timestamp when dbt loaded this row.

  - name: fct_artificial_lift_daily
    description: >
      Daily operational readings for artificial lift installations per ProdView
      completion. Covers both plunger lift (pvUnitCompPumpPlunger) and rod pump
      (pvUnitCompPumpRod) in a single UNION fact with a `lift_type` discriminator.

      Enables artificial lift performance analytics: trip count trends, travel time
      monitoring, SPM and stroke length tracking, and per-completion efficiency analysis.

      **Grain:** one row per daily reading per lift installation.
      Natural key: (id_rec, lift_type). Surrogate key: MD5(id_rec || lift_type).

      **Lift type hierarchy (both go through artificial_lift header):**
      - Plunger: readings → plunger_lifts → artificial_lift_header → completion → unit → well_360
        (plunger_lifts.completion_id maps to artificial_lift.id_rec, not directly to completions)
      - Rod pump: entries → rod_pump_configs → artificial_lift_header → completion → unit → well_360

      **Lift-type-specific columns:** Plunger columns (travel time, trip counts, duration)
      are NULL for rod_pump rows. Rod pump columns (spm, stroke_length_in, run_time_pct,
      vol_per_day_calc_bbl) are NULL for plunger rows.

      **Rows:** ~79K as of Sprint 9 (61K plunger + 18K rod pump).
    config:
      tags: ["marts", "fo", "well_360"]
    columns:
      - name: artificial_lift_daily_sk
        description: Surrogate key. MD5(id_rec || lift_type). Unique per reading.
        data_tests:
          - not_null
          - unique

      - name: id_rec
        description: Source reading record ID (natural key within lift_type).
        data_tests:
          - not_null

      - name: lift_type
        description: >
          Lift installation type discriminator. Either 'plunger' (pvUnitCompPumpPlunger)
          or 'rod_pump' (pvUnitCompPumpRod).
        data_tests:
          - not_null

      - name: id_rec_comp
        description: >
          FK to pvUnitComp (completion record ID). Resolution path:
          plunger readings → plunger_lifts.completion_id;
          rod pump entries → rod_pump_configs → artificial_lift_header.id_rec_parent.
        data_tests:
          - not_null

      - name: eid
        description: >
          Well EID resolved via completions → unit → well_360. NULL for completions
          not registered in the well_360 spine.
        data_tests:
          - not_null:
              config:
                severity: warn
          - relationships:
              arguments:
                to: ref('well_360')
                field: eid
              config:
                severity: warn

      - name: is_eid_unresolved
        description: True when EID could not be resolved via either prodview_unit_id or api_10.
        data_tests:
          - not_null

      - name: reading_date
        description: Date of the daily reading. Entry_date for plunger; observation_date for rod pump.
        data_tests:
          - not_null:
              config:
                severity: warn

      - name: on_pressure_psi
        description: >
          Plunger on-pressure in PSI (converted from kPa). NULL for rod_pump rows.

      - name: off_pressure_psi
        description: Off-pressure in PSI. Currently NULL for both lift types (reserved).

      - name: total_trips_or_cycles
        description: Total trip/cycle count for the day. Plunger only; NULL for rod_pump.

      - name: successful_trips_or_arrivals
        description: Successful trips (plunger arrivals). Plunger only; NULL for rod_pump.

      - name: failed_trips_or_misses
        description: Failed trips (plunger misses). Plunger only; NULL for rod_pump.

      - name: duration_on_minutes
        description: Duration on-time in minutes (plunger). NULL for rod_pump.

      - name: duration_off_minutes
        description: Duration off-time in minutes (plunger). NULL for rod_pump.

      - name: after_flow_time_hours
        description: After-flow time in hours (plunger). NULL for rod_pump.

      - name: travel_time_avg_minutes
        description: Average plunger travel time in minutes. NULL for rod_pump.

      - name: travel_time_max_minutes
        description: Maximum plunger travel time in minutes. NULL for rod_pump.

      - name: travel_time_min_minutes
        description: Minimum plunger travel time in minutes. NULL for rod_pump.

      - name: travel_time_target_minutes
        description: Target plunger travel time in minutes. NULL for rod_pump.

      - name: spm
        description: Strokes per minute (rod pump). NULL for plunger.

      - name: stroke_length_in
        description: Stroke length in inches (rod pump; converted from meters). NULL for plunger.

      - name: run_time_pct
        description: Run time percentage (rod pump). NULL for plunger.

      - name: vol_per_day_calc_bbl
        description: Calculated volume per day in barrels (rod pump; converted from m³). NULL for plunger.

      - name: comments
        description: Operator comments on the reading.

      - name: _loaded_at
        description: Timestamp when dbt loaded this row.
